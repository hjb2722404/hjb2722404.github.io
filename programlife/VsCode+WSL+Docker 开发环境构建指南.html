<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VsCode+WSL+Docker 开发环境构建指南 | 林中路</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="
Why——为什么整这种活

在实际开发中，我们遇到了以下类型的问题：

1. 不同工程对nodejs版本要求不一样

比如我们的工程A是基于angularjs1.5的，它要求nodejs版本为11.0.0， 而工程B是基于vue+vite的，vite要求nodejs版本需要大于12.0.0。

尽管有nvm来管理nodejs版本，但它仍旧存在以 ...">
    
    <link rel="preload" href="/assets/css/0.styles.6d0d6f13.css" as="style"><link rel="preload" href="/assets/js/app.cd8205c8.js" as="script"><link rel="preload" href="/assets/js/11.4c288b74.js" as="script"><link rel="preload" href="/assets/js/108.51e66dbe.js" as="script"><link rel="prefetch" href="/assets/js/1.c492b4cd.js"><link rel="prefetch" href="/assets/js/10.5c791580.js"><link rel="prefetch" href="/assets/js/100.98ff7760.js"><link rel="prefetch" href="/assets/js/101.e5cd16d7.js"><link rel="prefetch" href="/assets/js/102.cc9bc85b.js"><link rel="prefetch" href="/assets/js/103.7b07b598.js"><link rel="prefetch" href="/assets/js/104.ee58d457.js"><link rel="prefetch" href="/assets/js/105.48c57f25.js"><link rel="prefetch" href="/assets/js/106.b702757c.js"><link rel="prefetch" href="/assets/js/107.8122f1ef.js"><link rel="prefetch" href="/assets/js/109.3145253b.js"><link rel="prefetch" href="/assets/js/110.f9990065.js"><link rel="prefetch" href="/assets/js/111.3263bd3f.js"><link rel="prefetch" href="/assets/js/112.9071b5e2.js"><link rel="prefetch" href="/assets/js/113.f131242e.js"><link rel="prefetch" href="/assets/js/114.7a6e09f7.js"><link rel="prefetch" href="/assets/js/115.508d99ac.js"><link rel="prefetch" href="/assets/js/116.f4900a92.js"><link rel="prefetch" href="/assets/js/117.e5957144.js"><link rel="prefetch" href="/assets/js/118.062eb3c1.js"><link rel="prefetch" href="/assets/js/119.93634bcc.js"><link rel="prefetch" href="/assets/js/12.c3b16095.js"><link rel="prefetch" href="/assets/js/120.1bada0ab.js"><link rel="prefetch" href="/assets/js/121.7d55e294.js"><link rel="prefetch" href="/assets/js/122.b7f7c837.js"><link rel="prefetch" href="/assets/js/123.3a0b4694.js"><link rel="prefetch" href="/assets/js/124.bd458b77.js"><link rel="prefetch" href="/assets/js/125.8ca612c9.js"><link rel="prefetch" href="/assets/js/126.35bccb3e.js"><link rel="prefetch" href="/assets/js/127.9b3097f5.js"><link rel="prefetch" href="/assets/js/128.5833cf40.js"><link rel="prefetch" href="/assets/js/129.38ec9907.js"><link rel="prefetch" href="/assets/js/13.91404f5a.js"><link rel="prefetch" href="/assets/js/130.932a54c4.js"><link rel="prefetch" href="/assets/js/131.f4ab894a.js"><link rel="prefetch" href="/assets/js/14.ef93462f.js"><link rel="prefetch" href="/assets/js/15.83829c35.js"><link rel="prefetch" href="/assets/js/16.d245c760.js"><link rel="prefetch" href="/assets/js/17.4a9f3c99.js"><link rel="prefetch" href="/assets/js/18.75ce45c7.js"><link rel="prefetch" href="/assets/js/19.b86d35ae.js"><link rel="prefetch" href="/assets/js/20.9657eb2e.js"><link rel="prefetch" href="/assets/js/21.f89cf353.js"><link rel="prefetch" href="/assets/js/22.746aec5f.js"><link rel="prefetch" href="/assets/js/23.ca2ee980.js"><link rel="prefetch" href="/assets/js/24.e1eeb0f4.js"><link rel="prefetch" href="/assets/js/25.f96e0147.js"><link rel="prefetch" href="/assets/js/26.cc4cf83e.js"><link rel="prefetch" href="/assets/js/27.f940e542.js"><link rel="prefetch" href="/assets/js/28.99771a3c.js"><link rel="prefetch" href="/assets/js/29.841b64b0.js"><link rel="prefetch" href="/assets/js/30.772e1ff4.js"><link rel="prefetch" href="/assets/js/31.7e0b62c5.js"><link rel="prefetch" href="/assets/js/32.cf3d5fb6.js"><link rel="prefetch" href="/assets/js/33.b338e29a.js"><link rel="prefetch" href="/assets/js/34.8b8356fe.js"><link rel="prefetch" href="/assets/js/35.1b12a1f7.js"><link rel="prefetch" href="/assets/js/36.547e2f8d.js"><link rel="prefetch" href="/assets/js/37.36a240bd.js"><link rel="prefetch" href="/assets/js/38.4f6b92e3.js"><link rel="prefetch" href="/assets/js/39.5133d0dd.js"><link rel="prefetch" href="/assets/js/4.524efd0b.js"><link rel="prefetch" href="/assets/js/40.8c765af6.js"><link rel="prefetch" href="/assets/js/41.b7234e21.js"><link rel="prefetch" href="/assets/js/42.b5ac212a.js"><link rel="prefetch" href="/assets/js/43.5d1b3b6c.js"><link rel="prefetch" href="/assets/js/44.eda633f8.js"><link rel="prefetch" href="/assets/js/45.39f5263b.js"><link rel="prefetch" href="/assets/js/46.f1fbfada.js"><link rel="prefetch" href="/assets/js/47.ed969447.js"><link rel="prefetch" href="/assets/js/48.e1867366.js"><link rel="prefetch" href="/assets/js/49.c2a4bc6b.js"><link rel="prefetch" href="/assets/js/5.a180cf14.js"><link rel="prefetch" href="/assets/js/50.da77d6a3.js"><link rel="prefetch" href="/assets/js/51.4183e6ab.js"><link rel="prefetch" href="/assets/js/52.b18add11.js"><link rel="prefetch" href="/assets/js/53.08c1d448.js"><link rel="prefetch" href="/assets/js/54.9edeb19b.js"><link rel="prefetch" href="/assets/js/55.9a3ed63e.js"><link rel="prefetch" href="/assets/js/56.dcf34dca.js"><link rel="prefetch" href="/assets/js/57.2123aa49.js"><link rel="prefetch" href="/assets/js/58.c9833b3b.js"><link rel="prefetch" href="/assets/js/59.8da7c174.js"><link rel="prefetch" href="/assets/js/6.529edc8a.js"><link rel="prefetch" href="/assets/js/60.9a70415e.js"><link rel="prefetch" href="/assets/js/61.35935df8.js"><link rel="prefetch" href="/assets/js/62.0e63cfe7.js"><link rel="prefetch" href="/assets/js/63.a52d5a72.js"><link rel="prefetch" href="/assets/js/64.cf7dfcc7.js"><link rel="prefetch" href="/assets/js/65.0220a5ee.js"><link rel="prefetch" href="/assets/js/66.5cd774f3.js"><link rel="prefetch" href="/assets/js/67.d8943555.js"><link rel="prefetch" href="/assets/js/68.7cf24f78.js"><link rel="prefetch" href="/assets/js/69.56501738.js"><link rel="prefetch" href="/assets/js/7.ac95b826.js"><link rel="prefetch" href="/assets/js/70.9626260f.js"><link rel="prefetch" href="/assets/js/71.a466c6f1.js"><link rel="prefetch" href="/assets/js/72.0a678f77.js"><link rel="prefetch" href="/assets/js/73.597ea695.js"><link rel="prefetch" href="/assets/js/74.a0387d5c.js"><link rel="prefetch" href="/assets/js/75.97871f2e.js"><link rel="prefetch" href="/assets/js/76.7d8e44c7.js"><link rel="prefetch" href="/assets/js/77.b53c8e31.js"><link rel="prefetch" href="/assets/js/78.9fef1461.js"><link rel="prefetch" href="/assets/js/79.9af76496.js"><link rel="prefetch" href="/assets/js/8.6bb76bea.js"><link rel="prefetch" href="/assets/js/80.5f7ee3db.js"><link rel="prefetch" href="/assets/js/81.1937e784.js"><link rel="prefetch" href="/assets/js/82.2bdeb675.js"><link rel="prefetch" href="/assets/js/83.e04a8620.js"><link rel="prefetch" href="/assets/js/84.ca8713d0.js"><link rel="prefetch" href="/assets/js/85.40f655ff.js"><link rel="prefetch" href="/assets/js/86.87397155.js"><link rel="prefetch" href="/assets/js/87.798cdf26.js"><link rel="prefetch" href="/assets/js/88.e089f692.js"><link rel="prefetch" href="/assets/js/89.5d842e18.js"><link rel="prefetch" href="/assets/js/9.5b2ac283.js"><link rel="prefetch" href="/assets/js/90.4157be98.js"><link rel="prefetch" href="/assets/js/91.7ed6afe7.js"><link rel="prefetch" href="/assets/js/92.9c50ce3b.js"><link rel="prefetch" href="/assets/js/93.e8e16a70.js"><link rel="prefetch" href="/assets/js/94.cf98a377.js"><link rel="prefetch" href="/assets/js/95.a4b78938.js"><link rel="prefetch" href="/assets/js/96.a7a9f018.js"><link rel="prefetch" href="/assets/js/97.f96c42c9.js"><link rel="prefetch" href="/assets/js/98.ce7378e5.js"><link rel="prefetch" href="/assets/js/99.24959418.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.706cf0ce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d0d6f13.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="header"><div class="blog-info" data-v-54e0dde5>
   林中路
   <p data-v-54e0dde5>少有人走的路，逐渐向世界显现</p></div> <div class="blog-author-info" data-v-51bc2051><p class="author-head-img" data-v-51bc2051><img src="/assets/img/head-img.8e2d0100.png" alt data-v-51bc2051></p></div> <div class="blog-category-list" data-v-581efa6b><ul data-v-581efa6b></ul></div></div> <div class="content"><div class="template-container" data-v-b70586ba><div class="content" data-v-b70586ba><div class="content__default" data-v-b70586ba><h1 id="vscode-wsl-docker-开发环境构建指南"><a href="#vscode-wsl-docker-开发环境构建指南" class="header-anchor">#</a> VsCode+WSL+Docker 开发环境构建指南</h1> <h2 id="why-为什么整这种活"><a href="#why-为什么整这种活" class="header-anchor">#</a> Why——为什么整这种活</h2> <p>在实际开发中，我们遇到了以下类型的问题：</p> <h3 id="_1-不同工程对nodejs版本要求不一样"><a href="#_1-不同工程对nodejs版本要求不一样" class="header-anchor">#</a> 1. 不同工程对nodejs版本要求不一样</h3> <p>比如我们的工程A是基于<code>angularjs1.5</code>的，它要求<code>nodejs</code>版本为<code>11.0.0</code>， 而工程B是基于<code>vue+vite</code>的，<code>vite</code>要求<code>nodejs</code>版本需要大于<code>12.0.0</code>。</p> <p>尽管有<code>nvm</code>来管理<code>nodejs</code>版本，但它仍旧存在以下问题：</p> <ol><li><p>全局环境污染</p> <p>比如<code>angularjs</code>工程是基于<code>gulp</code>的，所以需要全局安装<code>gulp</code>包，但是其他工程用不到，而<code>vue</code>工程则需要全局安装<code>vue-cli</code>，这样同一个<code>windows</code>环境下，安装了太多全局包，如果以后又有别的项目工程需要其他的全局包，那我们都得安装在同一个环境下，万一有两个工程所依赖的全局包相同但版本不同，就会造成全局环境的污染</p></li> <li><p>切换<code>node</code>版本后全局包需要重新安装</p> <p>切换本地<code>node</code>版本后，在之前<code>node</code>版本下安装的全局包都无法使用，需要重新安装，比如我们常用的<code>cnpm</code>、<code>nrm</code>等等。</p></li> <li><p><code>nvm</code>本身的安装也存在一些坑。</p> <p>之前好几位同事安装<code>nvm</code>都因为环境和版本的问题多多少少踩了一些坑，费时费力，不太安逸。</p></li></ol> <h3 id="_2-某些npm包需要linux编译环境"><a href="#_2-某些npm包需要linux编译环境" class="header-anchor">#</a> 2. 某些npm包需要linux编译环境</h3> <p>典型地，如<code>node-sass</code>这个包，比如当我们想将它从<code>4.4.1</code>版本升级到<code>6.0.1</code>版本时，我们会敲下以下命令:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
$ <span class="token function">npm</span> <span class="token function">install</span> node-sass@6.0.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后，噩梦就来临了，由于<code>node-sass</code>采用的是二进制文件分发，所以需要本地具有可以编译它的环境，比如<code>python</code>，<code>gyp</code>等等，但是一般来说，我们的<code>Windows</code>上并没有这些环境，所以就会报一堆错，而<code>Windows</code>如果想要安装这种环境，又需要安装一些很冷门还很难装的软件与库，搞得及其烦人。</p> <h3 id="_3-需要适应未来devops转型"><a href="#_3-需要适应未来devops转型" class="header-anchor">#</a> 3. 需要适应未来DevOps转型</h3> <p>现在很多大厂已经转型<code>DevOps</code>了，云计算和容器化是一种大趋势，随着业务量与项目数量的增长，开发和运维都面临着向DevOps的转型，所以提前进行容器化开发，可以为未来<code>容器化开发——容器化部署</code>模式铺平道路。</p> <h2 id="what-方案简述"><a href="#what-方案简述" class="header-anchor">#</a> What——方案简述</h2> <p>我们采用<code>Vscode + Docker + WSL</code>来解决上述问题。</p> <h3 id="vscode"><a href="#vscode" class="header-anchor">#</a> VsCode</h3> <p>不必多介绍，一款流行的编辑器，在本方案中，它只需要安装两个插件即可：</p> <ul><li><code>Remote-Containers</code>：用于连接远程容器</li> <li><code>Remote-WSL</code>： 用于连接本地的WSL</li></ul> <h3 id="wsl-windows-subsystem-linux"><a href="#wsl-windows-subsystem-linux" class="header-anchor">#</a> WSL（windows subsystem linux）</h3> <p>Windows系统下的Linux子系统，它在这里主要起的作用是用来提供一个linux环境，一是提供给docker作为运行环境，二是用来解决上述某些npm包需要linux编译环境的问题。</p> <p>想更深入地了解WSL？ <a href="https://docs.microsoft.com/zh-cn/windows/wsl/about" target="_blank" rel="noopener noreferrer">点击这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h3> <p>一款容器应用，它可以提供比虚拟机更加快捷和对硬件资源消耗更少的虚拟化方案，为我们的提供一个虚拟的服务器和开发环境。</p> <p><a href="https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-containers" target="_blank" rel="noopener noreferrer">WSL上的Docker远程容器入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="how-如何搭建"><a href="#how-如何搭建" class="header-anchor">#</a> How——如何搭建</h2> <h3 id="_1-安装配置wsl-2-0版本"><a href="#_1-安装配置wsl-2-0版本" class="header-anchor">#</a> 1. 安装配置WSL 2.0版本</h3> <p>最新的Windws10默认都是直接支持WSL2的，我们只需要在windows应用商店搜索<code>linux</code>，就能看到支持的<code>Linux</code>子系统列表，选择其中一个安装就可以了。</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090920251.png" alt="image-20211009092023034"></p> <p>当然，推荐的话，还是<code>ubuntu</code>比较流行，遇到问题也比较容易搜索到相关解决方案。</p> <p>为了更好地操作，推荐在应用商店中搜索<code>windows terminal</code>安装。</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090922910.png" alt="image-20211009092216803"></p> <p>另外，由于WSL是基于Hype-V技术的，需要Windows开启相关功能，并且保证BIOS中的虚拟化选项开启，由于不同电脑BIOS的设置方式不同，请自行在网络上搜索相关设置方法。</p> <p>如何判断电脑是否开启了虚拟化呢？ 打开任务管理器，切换到【性能】一栏，可以看到【CPU】下面的信息中标识了是否开启了虚拟化：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090924656.png" alt="image-20211009092430535"></p> <p><a href="https://docs.microsoft.com/zh-cn/windows/wsl/install" target="_blank" rel="noopener noreferrer">官方WSL安装教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://docs.microsoft.com/zh-cn/windows/wsl/setup/environment" target="_blank" rel="noopener noreferrer">WSL开发环境设置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>安装后，我们需要对默认WSL发新版和发行版的版本进行配置</p> <p>在windows搜索框里输入 windows terminal，打开它</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121845212.png" alt="image-20211012184537098"></p> <p>输入以下命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> wsl -l --verbose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>会列出本机现在安装的所有WSL发行版以及它的版本</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  NAME                   STATE           VERSION
* Ubuntu                 Running         <span class="token number">2</span>
  docker-desktop-data    Running         <span class="token number">2</span>
  docker-desktop         Running         <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>系统默认的那个发行版前会有一个<code>*</code>号，也就是，当你在<code>windows Terminal</code>中直接输入<code>wsl</code>时，打开的那个发行版：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>PS C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>trs<span class="token operator">&gt;</span> wsl
root@DESKTOP-RG3539D:/mnt/c/Users/trs<span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果你发现你刚刚安装的<code>Ubuntu</code>不是默认的发行版，使用以下命令将它设置为默认发行版：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> wsl --set-default ubuntu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果你发现你的<code>Ubuntu</code>的版本不是<code>2</code>,使用以下命令转换其版本：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> wsl --set-version ubuntu <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-安装配置docker"><a href="#_2-安装配置docker" class="header-anchor">#</a> 2. 安装配置Docker</h3> <p>Windows需要去官网下载Docker desktop最新版本，下载安装文件后直接安装即可。</p> <p><a href="https://docs.docker.com/desktop/windows/wsl/" target="_blank" rel="noopener noreferrer">点击这里下载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090927230.png" alt="image-20211009092713131"></p> <p>安装好之后，我们要进行以下配置，运行<code>docker-desktop</code>程序</p> <p>保证以下选项为勾选状态：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121853544.png" alt="image-20211012185324443"></p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121854848.png" alt="image-20211012185406762"></p> <p>修改一下<code>docker</code>镜像源和配置：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121856738.png" alt="image-20211012185645645"></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;http://hub-mirror.c.163.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;experimental&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;buildkit&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;builder&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;gc&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;enabled&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;defaultKeepStorage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;20GB&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_3-安装配置vscode相关插件"><a href="#_3-安装配置vscode相关插件" class="header-anchor">#</a> 3. 安装配置VsCode相关插件</h3> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090928351.png" alt="image-20211009092815254"></p> <h3 id="_4-在wsl容器中开发调试应用"><a href="#_4-在wsl容器中开发调试应用" class="header-anchor">#</a> 4. 在WSL容器中开发调试应用</h3> <h5 id="自动创建容器"><a href="#自动创建容器" class="header-anchor">#</a> 自动创建容器</h5> <p>插件安装成功后，在<code>VsCode</code>中打开工程目录，会看到左下角有两个相对的箭头的标识，点击它，就会弹出命令选项，让我们选择在哪里打开：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090930143.png" alt="image-20211009093045937"></p> <p>在确保<code>docker desktop</code> 正常运行的前提下，我们可以选择在<code>WSL</code>中开发目录，也可以选择在容器内打开当前工程目录，这里我们选择在容器内打开。它会让我们选择要打开的目录，默认为当前目录：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090938031.png" alt="image-20211009093849854"></p> <p>我们直接点击【Open】，它会让我们选择当前工程的环境类型：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090940780.png" alt="image-20211009094008663"></p> <p>这里是前端项目，我们直接选择【Nodejs】，然后它会让我们选择当前工程所使用的<code>nodejs</code>版本，选择相应的版本，就可以了，容器会自动下载相关的<code>nodejs</code>环境。</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110091001533.png" alt="image-20211009100141449"></p> <p><code>VsCode</code>在配置好相关环境后，会在当前目录下生成一个一个名为<code>.devcontainer</code>的文件夹，里面存放着容器的环境配置，有了这个配置，下次再在容器中打开工程目录时，就不会再让我们选择工程环境类型了。</p> <p>当然，为了不污染项目文件，可以把这个目录加入到<code>.gitignore</code>文件中。</p> <p>之后，我们就可以像在本地开发一样，在容器内进行开发了。</p> <h5 id="手动创建容器"><a href="#手动创建容器" class="header-anchor">#</a> 手动创建容器</h5> <p>我们发现，在选择<code>NodeJS</code>版本那一步，只有少数几个版本，比如我们需要<code>10.17.0</code>的话，这里就没有，怎么办呢，我们有另一种方式。</p> <p>在工程根目录下新建<code>Dockerfile</code>文件，</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> node:10.17.0 # 这里写上需要的nodejs版本</span>

<span class="token instruction"><span class="token keyword">WORKDIR</span> /usr/src/app</span>

<span class="token instruction"><span class="token keyword">COPY</span> package*.json ./</span>

<span class="token instruction"><span class="token keyword">RUN</span> npm install</span>

<span class="token instruction"><span class="token keyword">COPY</span> . .</span>

<span class="token instruction"><span class="token keyword">EXPOSE</span> 8090 # 这里是应用在开发时默认运行的端口</span>

<span class="token instruction"><span class="token keyword">CMD</span> [ <span class="token string">&quot;npm&quot;</span>, <span class="token string">&quot;run&quot;</span>, <span class="token string">&quot;serve&quot;</span>]  # 拆解的开发命令 npm run serve</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>然后新建docker忽略文件<code>.dockerignore</code> :</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>node_modules
npm-debug.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>新建后，点击左下角远程容器按钮，选择【在WSL中打开】：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121904365.png" alt="image-20211012190451098"></p> <p>选择当前目录打开：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121905722.png" alt="image-20211012190546522"></p> <p>在VS code 终端中，可以看到现在终端是在WSL中，运行以下命令:,(可以把<code>hjb/netresource</code>替换成你自己想要的任何可以描述该容器的名字)</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>root@DESKTOP-RG3539D:/mnt/d/project/tianmuyun/netresource<span class="token comment"># docker build . -t hjb/netresource</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的命令会构建一个新的镜像，镜像中包含所需要的node版本环境和你的工程代码。</p> <p>接下来运行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>root@DESKTOP-RG3539D:/mnt/d/project/tianmuyun/netresource<span class="token comment"># docker run -p 8090:8090 -d hjb/netresource</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的命令会使用你刚刚构建的镜像实例化一个容器，并且会自动运行你在<code>Dockerfile</code>最后所设置的命令（这里是<code>npm run serve</code>），并且将容器内应用的运行端口<code>8090</code>映射到了本机的<code>8090</code>端口</p> <p>然后可以通过下面命令看看运行的容器：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS                                       NAMES
2e569ac583be   hjb/netresource   <span class="token string">&quot;docker-entrypoint.s…&quot;</span>   <span class="token number">6</span> seconds ago   Up <span class="token number">3</span> seconds   <span class="token number">0.0</span>.0.0:8090-<span class="token operator">&gt;</span><span class="token number">8090</span>/tcp, :::8090-<span class="token operator">&gt;</span><span class="token number">8090</span>/tcp   inspiring_khorana
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这里我们可以拿到输出的容器ID，用这个ID来查看docker内的运行日志：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># docker logs 2e569ac583be</span>

 net-resource@0.1.0 build /usr/src/app
<span class="token operator">&gt;</span> vue-cli-service build


-  Building <span class="token keyword">for</span> production<span class="token punctuation">..</span>.
Browserslist: caniuse-lite is outdated. Please run:
npx browserslist@latest --update-db
Browserslist: caniuse-lite is outdated. Please run:
npx browserslist@latest --update-db
Browserslist: caniuse-lite is outdated. Please run:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>当然，我们也可以在windows的docker-desktop里看到刚刚实例化运行起来的容器运行日志：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121915835.png" alt="image-20211012191534715"></p> <p>从日志看到应用成功运行起来后，就可以在本地访问<code>8090</code>端口来浏览应用了。</p> <p>当然，此时，我们修改工作区的内容，容器内的应用并不会刷新，因为现在容器内打开的是我们复制到容器中<code>usr/src/app</code>里的代码，而不是我们工作区的代码。要想像在windows下一样调试，可以进行以下操作：</p> <p>点击远程容器图标：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130942111.png" alt="image-20211013094238016"></p> <p>选择关闭远程连接</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130943461.png" alt="image-20211013094318379"></p> <p>然后重新点击本地的远程容器图标：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130943915.png" alt="image-20211013094356859"></p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130944393.png" alt="image-20211013094421304"></p> <p>选择进入一个运行中的容器，</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130945673.png" alt="image-20211013094503611"></p> <p>选择我们之前运行起来的容器，此时VSCODE会打开一个新的远程窗口</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130949042.png" alt="image-20211013094905936"></p> <p>我们在新窗口的工作区目录区域右键，选择添加文件夹到工作区，然后在弹出的框里输入我们在<code>DockerFile</code>里设置的<code>WORKDIR</code>路径，选择并确定</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130950150.png" alt="image-20211013095007073"></p> <p>然后工作区目录中就有我们在容器内运行的工程文件了。</p> <p>接下来就可以像在平时<code>windows</code>下一样修改和调试代码了，如果想进行git操作，在VSCODE中打开终端像平时操作一样就可以了。</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130953170.png" alt="image-20211013095314887"></p> <h3 id="_5-其它注意事项"><a href="#_5-其它注意事项" class="header-anchor">#</a> 5. 其它注意事项</h3> <ul><li>由于该容器与本机的<code>Git</code>共享凭证信息，所以即使在容器内，也可以进行与远程<code>Git</code>仓库的交互操作。</li> <li>尽管我们是在容器内打开的目录，但只是把本地目录挂载到了容器内，所以容器内对工程文件所做的修改，就是对本地目录内工程文件的修改。</li> <li>有一个例外，就是我们在容器内运行<code>npm install</code>安装的包，再切换回本地工程，是无法使用的，需要重新在本地跑<code>npm install</code>才行。</li></ul></div></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.cd8205c8.js" defer></script><script src="/assets/js/11.4c288b74.js" defer></script><script src="/assets/js/108.51e66dbe.js" defer></script>
  </body>
</html>
