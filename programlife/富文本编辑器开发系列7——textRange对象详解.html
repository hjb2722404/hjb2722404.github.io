<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>富文本编辑器开发系列——textRange对象API详解 | 林中路</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="
textRange对象简介

在IE9浏览器和更早版本的浏览器中，是没有提供用来表示选区的Range对象的API的，但是它们依旧有可编辑区域的相关能力，是因为它们提供了另一个对象接口：textRange对象

textRange对象属性与API概览

![](https://gitee.com/hjb2722404/tuchuang/raw/master/img/2 ...">
    
    <link rel="preload" href="/assets/css/0.styles.6d0d6f13.css" as="style"><link rel="preload" href="/assets/js/app.cd8205c8.js" as="script"><link rel="preload" href="/assets/js/11.4c288b74.js" as="script"><link rel="preload" href="/assets/js/128.5833cf40.js" as="script"><link rel="prefetch" href="/assets/js/1.c492b4cd.js"><link rel="prefetch" href="/assets/js/10.5c791580.js"><link rel="prefetch" href="/assets/js/100.98ff7760.js"><link rel="prefetch" href="/assets/js/101.e5cd16d7.js"><link rel="prefetch" href="/assets/js/102.cc9bc85b.js"><link rel="prefetch" href="/assets/js/103.7b07b598.js"><link rel="prefetch" href="/assets/js/104.ee58d457.js"><link rel="prefetch" href="/assets/js/105.48c57f25.js"><link rel="prefetch" href="/assets/js/106.b702757c.js"><link rel="prefetch" href="/assets/js/107.8122f1ef.js"><link rel="prefetch" href="/assets/js/108.51e66dbe.js"><link rel="prefetch" href="/assets/js/109.3145253b.js"><link rel="prefetch" href="/assets/js/110.f9990065.js"><link rel="prefetch" href="/assets/js/111.3263bd3f.js"><link rel="prefetch" href="/assets/js/112.9071b5e2.js"><link rel="prefetch" href="/assets/js/113.f131242e.js"><link rel="prefetch" href="/assets/js/114.7a6e09f7.js"><link rel="prefetch" href="/assets/js/115.508d99ac.js"><link rel="prefetch" href="/assets/js/116.f4900a92.js"><link rel="prefetch" href="/assets/js/117.e5957144.js"><link rel="prefetch" href="/assets/js/118.062eb3c1.js"><link rel="prefetch" href="/assets/js/119.93634bcc.js"><link rel="prefetch" href="/assets/js/12.c3b16095.js"><link rel="prefetch" href="/assets/js/120.1bada0ab.js"><link rel="prefetch" href="/assets/js/121.7d55e294.js"><link rel="prefetch" href="/assets/js/122.b7f7c837.js"><link rel="prefetch" href="/assets/js/123.3a0b4694.js"><link rel="prefetch" href="/assets/js/124.bd458b77.js"><link rel="prefetch" href="/assets/js/125.8ca612c9.js"><link rel="prefetch" href="/assets/js/126.35bccb3e.js"><link rel="prefetch" href="/assets/js/127.9b3097f5.js"><link rel="prefetch" href="/assets/js/129.38ec9907.js"><link rel="prefetch" href="/assets/js/13.91404f5a.js"><link rel="prefetch" href="/assets/js/130.932a54c4.js"><link rel="prefetch" href="/assets/js/131.f4ab894a.js"><link rel="prefetch" href="/assets/js/14.ef93462f.js"><link rel="prefetch" href="/assets/js/15.83829c35.js"><link rel="prefetch" href="/assets/js/16.d245c760.js"><link rel="prefetch" href="/assets/js/17.4a9f3c99.js"><link rel="prefetch" href="/assets/js/18.75ce45c7.js"><link rel="prefetch" href="/assets/js/19.b86d35ae.js"><link rel="prefetch" href="/assets/js/20.9657eb2e.js"><link rel="prefetch" href="/assets/js/21.f89cf353.js"><link rel="prefetch" href="/assets/js/22.746aec5f.js"><link rel="prefetch" href="/assets/js/23.ca2ee980.js"><link rel="prefetch" href="/assets/js/24.e1eeb0f4.js"><link rel="prefetch" href="/assets/js/25.f96e0147.js"><link rel="prefetch" href="/assets/js/26.cc4cf83e.js"><link rel="prefetch" href="/assets/js/27.f940e542.js"><link rel="prefetch" href="/assets/js/28.99771a3c.js"><link rel="prefetch" href="/assets/js/29.841b64b0.js"><link rel="prefetch" href="/assets/js/30.772e1ff4.js"><link rel="prefetch" href="/assets/js/31.7e0b62c5.js"><link rel="prefetch" href="/assets/js/32.cf3d5fb6.js"><link rel="prefetch" href="/assets/js/33.b338e29a.js"><link rel="prefetch" href="/assets/js/34.8b8356fe.js"><link rel="prefetch" href="/assets/js/35.1b12a1f7.js"><link rel="prefetch" href="/assets/js/36.547e2f8d.js"><link rel="prefetch" href="/assets/js/37.36a240bd.js"><link rel="prefetch" href="/assets/js/38.4f6b92e3.js"><link rel="prefetch" href="/assets/js/39.5133d0dd.js"><link rel="prefetch" href="/assets/js/4.524efd0b.js"><link rel="prefetch" href="/assets/js/40.8c765af6.js"><link rel="prefetch" href="/assets/js/41.b7234e21.js"><link rel="prefetch" href="/assets/js/42.b5ac212a.js"><link rel="prefetch" href="/assets/js/43.5d1b3b6c.js"><link rel="prefetch" href="/assets/js/44.eda633f8.js"><link rel="prefetch" href="/assets/js/45.39f5263b.js"><link rel="prefetch" href="/assets/js/46.f1fbfada.js"><link rel="prefetch" href="/assets/js/47.ed969447.js"><link rel="prefetch" href="/assets/js/48.e1867366.js"><link rel="prefetch" href="/assets/js/49.c2a4bc6b.js"><link rel="prefetch" href="/assets/js/5.a180cf14.js"><link rel="prefetch" href="/assets/js/50.da77d6a3.js"><link rel="prefetch" href="/assets/js/51.4183e6ab.js"><link rel="prefetch" href="/assets/js/52.b18add11.js"><link rel="prefetch" href="/assets/js/53.08c1d448.js"><link rel="prefetch" href="/assets/js/54.9edeb19b.js"><link rel="prefetch" href="/assets/js/55.9a3ed63e.js"><link rel="prefetch" href="/assets/js/56.dcf34dca.js"><link rel="prefetch" href="/assets/js/57.2123aa49.js"><link rel="prefetch" href="/assets/js/58.c9833b3b.js"><link rel="prefetch" href="/assets/js/59.8da7c174.js"><link rel="prefetch" href="/assets/js/6.529edc8a.js"><link rel="prefetch" href="/assets/js/60.9a70415e.js"><link rel="prefetch" href="/assets/js/61.35935df8.js"><link rel="prefetch" href="/assets/js/62.0e63cfe7.js"><link rel="prefetch" href="/assets/js/63.a52d5a72.js"><link rel="prefetch" href="/assets/js/64.cf7dfcc7.js"><link rel="prefetch" href="/assets/js/65.0220a5ee.js"><link rel="prefetch" href="/assets/js/66.5cd774f3.js"><link rel="prefetch" href="/assets/js/67.d8943555.js"><link rel="prefetch" href="/assets/js/68.7cf24f78.js"><link rel="prefetch" href="/assets/js/69.56501738.js"><link rel="prefetch" href="/assets/js/7.ac95b826.js"><link rel="prefetch" href="/assets/js/70.9626260f.js"><link rel="prefetch" href="/assets/js/71.a466c6f1.js"><link rel="prefetch" href="/assets/js/72.0a678f77.js"><link rel="prefetch" href="/assets/js/73.597ea695.js"><link rel="prefetch" href="/assets/js/74.a0387d5c.js"><link rel="prefetch" href="/assets/js/75.97871f2e.js"><link rel="prefetch" href="/assets/js/76.7d8e44c7.js"><link rel="prefetch" href="/assets/js/77.b53c8e31.js"><link rel="prefetch" href="/assets/js/78.9fef1461.js"><link rel="prefetch" href="/assets/js/79.9af76496.js"><link rel="prefetch" href="/assets/js/8.6bb76bea.js"><link rel="prefetch" href="/assets/js/80.5f7ee3db.js"><link rel="prefetch" href="/assets/js/81.1937e784.js"><link rel="prefetch" href="/assets/js/82.2bdeb675.js"><link rel="prefetch" href="/assets/js/83.e04a8620.js"><link rel="prefetch" href="/assets/js/84.ca8713d0.js"><link rel="prefetch" href="/assets/js/85.40f655ff.js"><link rel="prefetch" href="/assets/js/86.87397155.js"><link rel="prefetch" href="/assets/js/87.798cdf26.js"><link rel="prefetch" href="/assets/js/88.e089f692.js"><link rel="prefetch" href="/assets/js/89.5d842e18.js"><link rel="prefetch" href="/assets/js/9.5b2ac283.js"><link rel="prefetch" href="/assets/js/90.4157be98.js"><link rel="prefetch" href="/assets/js/91.7ed6afe7.js"><link rel="prefetch" href="/assets/js/92.9c50ce3b.js"><link rel="prefetch" href="/assets/js/93.e8e16a70.js"><link rel="prefetch" href="/assets/js/94.cf98a377.js"><link rel="prefetch" href="/assets/js/95.a4b78938.js"><link rel="prefetch" href="/assets/js/96.a7a9f018.js"><link rel="prefetch" href="/assets/js/97.f96c42c9.js"><link rel="prefetch" href="/assets/js/98.ce7378e5.js"><link rel="prefetch" href="/assets/js/99.24959418.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.706cf0ce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d0d6f13.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="header"><div class="blog-info" data-v-54e0dde5>
   林中路
   <p data-v-54e0dde5>少有人走的路，逐渐向世界显现</p></div> <div class="blog-author-info" data-v-51bc2051><p class="author-head-img" data-v-51bc2051><img src="/assets/img/head-img.8e2d0100.png" alt data-v-51bc2051></p></div> <div class="blog-category-list" data-v-581efa6b><ul data-v-581efa6b></ul></div></div> <div class="content"><div class="template-container" data-v-b70586ba><div class="content" data-v-b70586ba><div class="content__default" data-v-b70586ba><h1 id="富文本编辑器开发系列-textrange对象api详解"><a href="#富文本编辑器开发系列-textrange对象api详解" class="header-anchor">#</a> 富文本编辑器开发系列——<code>textRange</code>对象<code>API</code>详解</h1> <h2 id="textrange对象简介"><a href="#textrange对象简介" class="header-anchor">#</a> textRange对象简介</h2> <p>在<code>IE9</code>浏览器和更早版本的浏览器中，是没有提供用来表示选区的<code>Range</code>对象的<code>API</code>的，但是它们依旧有可编辑区域的相关能力，是因为它们提供了另一个对象接口：<code>textRange</code>对象</p> <h2 id="textrange对象属性与api概览"><a href="#textrange对象属性与api概览" class="header-anchor">#</a> textRange对象属性与API概览</h2> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/20201210162002.png" alt=""></p> <h2 id="textrange-属性详解"><a href="#textrange-属性详解" class="header-anchor">#</a> textRange 属性详解</h2> <p>我们先直观地看一下这些属性。</p> <p>我们有下面一段代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">onscroll</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">UpdateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span> <span class="token property">left</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span>1px solid yellow<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span>400px<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span>scroll<span class="token punctuation">;</span> <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Select some content within this field.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>The coordinates of the selected content's boundary rectangle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>are visible in the field below<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>再来看页面中选中一个选区后各个属性所指向的</p> <p>从上面的思维导图中，我们可以看到这些属性的简要介绍。但是还有一些要注意的点</p> <h3 id="祖先元素中离它最近的定位元素"><a href="#祖先元素中离它最近的定位元素" class="header-anchor">#</a> 祖先元素中离它最近的定位元素</h3> <p>这其实指的就是的元素的<code>offsetParent</code> 属性指向的元素，也就是说对于当前选中区域所在的<code>textRange</code>对象，会一层一层往上找它的祖先元素，遇到的第一个定位元素。</p> <p>我们可以这样理解，获取到包含元素A的所有祖先元素，然后去除掉这些元素中的非定位元素，剩下的嵌套结构中元素A的父级元素就是它的 <code>offsetParent</code> 属性所指向的元素。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
  			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
 					 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
  						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              		这个是元素A  
             	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

// 去除非定位元素

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>A<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              		这个是元素A  
             	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
// 元素A的 offsetParent 指向的元素就是 className为 “5”的元素


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>这个属性，有以下原则：</p> <ul><li>如果元素自身的定位方式为<code>fixed</code> 或者<code>display</code>为<code>node</code>，则它的<code>offsetParent</code>为 <code>null</code>；</li> <li>如果元素的祖先元素里没有定位元素，并且元素本身没有定位，此时元素的<code>offsetParent</code> 为最近的<code>table/td/th或body</code>元素</li> <li>如果元素的祖先元素里没有定位元素，而元素定位为<code>absolute</code>或<code>relative</code> ，分两种情况：
<ul><li><code>IE7</code>以上和其它现代浏览器中，此时元素的<code>offsetParent</code> 为 最近的<code>table/td/th或body</code>元素；</li> <li><code>IE7</code> 以下版本浏览器中，此时元素的 <code>offsetParent</code> 为最近的<code>table/td/th或html</code>元素；</li></ul></li> <li>如果元素的祖先元素里有定位元素，而元素自身不是<code>fixed</code>定位，则元素的<code>offsetParent</code> 为离它最近的有定位的祖先元素。</li></ul> <p>知道了以上规则，我们就更好理解<code>textRange</code>对象的<code>offsetLeft</code>属性与<code>offsetTop</code>属性了。</p> <p>下面来看下这些属性的表现。</p> <p><strong>本文以下代码示例全部需要在IE9以下版本浏览器中才能正常运行</strong></p> <iframe src="https://codesandbox.io/embed/textrangeproperty-b52pk?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="textRange_property" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden;"></iframe> <p>运行效果：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/20201210162024.gif" alt=""></p> <p>我们拖动后选择的拖蓝区域形成了一个矩形区域，而<code>textRange</code> 对象的几个属性都和这个矩形区域有关：</p> <ul><li><code>boundingLeft</code>： 矩形区域左端到父窗口左边框右侧的坐标距离</li> <li><code>boundingTop</code>：矩形区域上端到父窗口上边框下侧的坐标距离</li> <li><code>boundingWidth</code> ： 矩形区域的宽度</li> <li><code>boundingHeight</code>： 矩形区域的高度</li> <li><code>offsetLeft</code>： 矩形区域左端到它最近的定位父级元素的左边框的右侧的距离（这里也是body，所以与left值相等）</li> <li><code>offsetTop</code>： 矩形区域上端到它最近的定位父级元素的上边框的下侧的距离（这里也是Body, 所以与 top值相等）</li></ul> <h2 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h2> <h3 id="collapse-start-闭合拖蓝"><a href="#collapse-start-闭合拖蓝" class="header-anchor">#</a> <code>collapse(start)</code>  闭合拖蓝</h3> <p>将拖蓝范围的起点移动到终点，反之亦然，同<code>range</code></p> <p>示例：</p> <p><img src="https://gitee.com/hjb2722404/tuchuang/raw/master/img/20201210162045.gif" alt=""></p> <p>示例说明：</p> <p>我们选中了一个选区‘button is released’，当我们释放鼠标时触发了事件，该事件调用了<code>collapse</code>方法将选区向终点闭合了，为了证明，我们在调用方法后，立即插入了一个按钮的内容，证明插入位置是选区终点处。</p> <h3 id="compareendpoints-比较拖蓝与指定对象"><a href="#compareendpoints-比较拖蓝与指定对象" class="header-anchor">#</a> <code>compareEndPoints</code>  比较拖蓝与指定对象</h3> <p>语法：<code>object.compareEndPoints(type, rangeToCompare);</code></p> <p>说明：比较另一个拖蓝对象与该拖蓝对象的两个端点的位置关系</p> <p>参数：</p> <ul><li>type： 比较哪两个端点
<ul><li>EndToEnd:  当前拖蓝的终点与目标对象的终点
<ul><li>EndToStart: 当前拖蓝的终点与目标对象的起点</li> <li>StartToEnd：当前拖蓝的起点与目标对象的终点</li> <li>StartToStart：当前拖蓝的起点与目标对象的起点</li></ul></li></ul></li> <li>rangeToCompare：要比较的目标拖蓝对象</li></ul> <p>返回值：</p> <ul><li>-1：第一个点在第二个点前面</li> <li>0：两个点在同一个位置</li> <li>1：第一个点在第二个点后面</li></ul> <p>示例</p> <iframe src="https://codesandbox.io/embed/floral-shape-dn89k?fontsize=14&amp;hidenavigation=1&amp;theme=dark" title="floral-shape-dn89k" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden;"></iframe> <p>示例说明： 我们的目标对象是文本中加粗的部分 ‘bold text’ ，而当前拖蓝对象就是我们鼠标拖动选区的范围，每一次选取，都会触发比较端点的方法，根据该方法返回的值，我们就可以判断出当前拖蓝与目标对象的位置关系。</p> <h3 id="duplicate-克隆拖蓝副本"><a href="#duplicate-克隆拖蓝副本" class="header-anchor">#</a> <code>duplicate()</code>  克隆拖蓝副本</h3> <p>语法： <code>object.duplicate();</code></p> <p>说明：返回一个当前拖蓝对象的副本，同 <code>range</code>对象的 <code>cloneRange</code>方法</p> <p>相关示例请移步<a href="/programlife/" class="router-link-active">rangeAPI</a></p> <blockquote><p>由于IE已经事实上出于死亡状态（截止写本文时，微软的Eage浏览器已经使用了谷歌的内核），以下IE下的API不再探讨。只供读者在阅读某些较旧的编辑器源码时当做参考用。</p></blockquote> <h3 id="execcommand-在当前拖蓝上执行命令"><a href="#execcommand-在当前拖蓝上执行命令" class="header-anchor">#</a> <code>execCommand()</code> 在当前拖蓝上执行命令</h3> <h3 id="expand-扩展拖蓝范围"><a href="#expand-扩展拖蓝范围" class="header-anchor">#</a> <code>expand</code>  扩展拖蓝范围</h3> <h3 id="findtext-搜索原先拖蓝内的指定文本-并调整拖蓝使其包含第一次匹配的内容"><a href="#findtext-搜索原先拖蓝内的指定文本-并调整拖蓝使其包含第一次匹配的内容" class="header-anchor">#</a> <code>findText</code> 搜索原先拖蓝内的指定文本，并调整拖蓝使其包含第一次匹配的内容</h3> <h3 id="getbookmark-保存当前拖蓝的端点位置"><a href="#getbookmark-保存当前拖蓝的端点位置" class="header-anchor">#</a> <code>getBookmark</code>  保存当前拖蓝的端点位置</h3> <h3 id="getboundingclientrect-返回拖蓝矩形对象相对于浏览器的位置大小信息"><a href="#getboundingclientrect-返回拖蓝矩形对象相对于浏览器的位置大小信息" class="header-anchor">#</a> <code>getBoundingClientRect</code> 返回拖蓝矩形对象相对于浏览器的位置大小信息</h3> <h3 id="getclientrects-返回当前拖蓝矩形对象形状信息"><a href="#getclientrects-返回当前拖蓝矩形对象形状信息" class="header-anchor">#</a> <code>getClientRects</code>  返回当前拖蓝矩形对象形状信息</h3> <h3 id="inrange-返回当前拖蓝是否包含指定拖蓝"><a href="#inrange-返回当前拖蓝是否包含指定拖蓝" class="header-anchor">#</a> <code>inRange</code> 返回当前拖蓝是否包含指定拖蓝</h3> <h3 id="isequal-返回当前拖蓝是否与指定拖蓝相等"><a href="#isequal-返回当前拖蓝是否与指定拖蓝相等" class="header-anchor">#</a> <code>isEqual</code> 返回当前拖蓝是否与指定拖蓝相等</h3> <h3 id="move-将拖蓝闭合-并将空白区域移动指定单位数"><a href="#move-将拖蓝闭合-并将空白区域移动指定单位数" class="header-anchor">#</a> <code>move</code>  将拖蓝闭合，并将空白区域移动指定单位数</h3> <h3 id="moveend-将拖蓝结束位置移动指定单位数"><a href="#moveend-将拖蓝结束位置移动指定单位数" class="header-anchor">#</a> <code>moveEnd</code>  将拖蓝结束位置移动指定单位数</h3> <h3 id="movestart-将拖蓝的开始位置移动指定单位数"><a href="#movestart-将拖蓝的开始位置移动指定单位数" class="header-anchor">#</a> <code>moveStart</code> 将拖蓝的开始位置移动指定单位数</h3> <h3 id="movetobookmark-获取保存的拖蓝位置信息"><a href="#movetobookmark-获取保存的拖蓝位置信息" class="header-anchor">#</a> <code>moveToBookMark</code>  获取保存的拖蓝位置信息</h3> <h3 id="movetoelementtext-使拖蓝包含指定元素的文本"><a href="#movetoelementtext-使拖蓝包含指定元素的文本" class="header-anchor">#</a> <code>moveToElementText</code> 使拖蓝包含指定元素的文本</h3> <h3 id="movetopoint-移动当前拖蓝的起点和终点到指定位置"><a href="#movetopoint-移动当前拖蓝的起点和终点到指定位置" class="header-anchor">#</a> <code>moveToPoint</code>  移动当前拖蓝的起点和终点到指定位置</h3> <h3 id="parentelement-返回拖蓝父元素"><a href="#parentelement-返回拖蓝父元素" class="header-anchor">#</a> <code>parentElement</code>  返回拖蓝父元素</h3> <h3 id="pastehtml-将html粘贴入给定的拖蓝-并替换拖蓝内原先的内容"><a href="#pastehtml-将html粘贴入给定的拖蓝-并替换拖蓝内原先的内容" class="header-anchor">#</a> <code>pasteHTML</code>  将HTML粘贴入给定的拖蓝，并替换拖蓝内原先的内容</h3> <h3 id="querycommandenabled-返回表明指定命令是否可用于给定文档当前状态下使用-exexcommand-命令成功事项的布尔值"><a href="#querycommandenabled-返回表明指定命令是否可用于给定文档当前状态下使用-exexcommand-命令成功事项的布尔值" class="header-anchor">#</a> <code>queryCommandEnabled</code>  返回表明指定命令是否可用于给定文档当前状态下使用 <code>exexCommand</code> 命令成功事项的布尔值</h3> <h3 id="querycommandstate-返回表明指定命令当前状态的布尔值"><a href="#querycommandstate-返回表明指定命令当前状态的布尔值" class="header-anchor">#</a> <code>queryCommandState</code>  返回表明指定命令当前状态的布尔值</h3> <h3 id="querycommandvalue-返回表明指定命令当前值的domstring"><a href="#querycommandvalue-返回表明指定命令当前值的domstring" class="header-anchor">#</a> <code>queryCommandValue</code>  返回表明指定命令当前值的<code>DOMString</code></h3> <h3 id="scrollintoview-将拖蓝滚动到可视范围内"><a href="#scrollintoview-将拖蓝滚动到可视范围内" class="header-anchor">#</a> <code>scrollIntoView</code> 将拖蓝滚动到可视范围内</h3> <h3 id="select-将当前拖蓝选中"><a href="#select-将当前拖蓝选中" class="header-anchor">#</a> <code>select</code>  将当前拖蓝选中</h3> <h3 id="setendpoint-根据其它拖蓝的端点设置当前拖蓝的结束点"><a href="#setendpoint-根据其它拖蓝的端点设置当前拖蓝的结束点" class="header-anchor">#</a> <code>setEndPoint</code>  根据其它拖蓝的端点设置当前拖蓝的结束点</h3></div></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.cd8205c8.js" defer></script><script src="/assets/js/11.4c288b74.js" defer></script><script src="/assets/js/128.5833cf40.js" defer></script>
  </body>
</html>
