(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{502:function(v,e,_){"use strict";_.r(e);var t=_(15),a=Object(t.a)({},(function(){var v=this,e=v.$createElement,_=v._self._c||e;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"ueditor源码分析-浏览器检测技术分析"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ueditor源码分析-浏览器检测技术分析"}},[v._v("#")]),v._v(" UEditor源码分析—— 浏览器检测技术分析")]),v._v(" "),_("p",[v._v("为了保证编辑器在各个不同浏览器上的一致性，"),_("code",[v._v("Ueditor")]),v._v("实现了一套完整而详细的浏览器内核和版本检测类，并且也将它挂载在了"),_("code",[v._v("UE")]),v._v("对象上，作为工具开放给开发者使用。")]),v._v(" "),_("div",{staticClass:"language-javascript line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-javascript"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[v._v("var")]),v._v(" browser "),_("span",{pre:!0,attrs:{class:"token operator"}},[v._v("=")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token constant"}},[v._v("UE")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(".")]),_("span",{pre:!0,attrs:{class:"token function-variable function"}},[v._v("browser")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[v._v("=")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[v._v("function")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("{")]),v._v("\n        "),_("span",{pre:!0,attrs:{class:"token comment"}},[v._v("// ...")]),v._v("\n    "),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("}")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(";")]),v._v("\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br"),_("span",{staticClass:"line-number"},[v._v("2")]),_("br"),_("span",{staticClass:"line-number"},[v._v("3")]),_("br")])]),_("p",[v._v("我们来看一下浏览器内核、平台与模式检测的实现原理。")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("对于"),_("code",[v._v("opera")]),v._v("浏览器，直接检查挂载在window上的"),_("code",[v._v("opera")]),v._v("对象")])]),v._v(" "),_("li",[_("p",[v._v("IE内核浏览器： 检查"),_("code",[v._v("navigator.userAgent")]),v._v("字符串中是否包含"),_("code",[v._v("msie")]),v._v("或者 "),_("code",[v._v("trident.*rv")]),v._v(" 子串")])]),v._v(" "),_("li",[_("p",[_("code",[v._v("webkit")]),v._v("内核浏览器： 检查"),_("code",[v._v("navigator.userAgent")]),v._v("字符串中是否包含"),_("code",[v._v("applewebkit")]),v._v(" 子串。")])]),v._v(" "),_("li",[_("p",[v._v("是否运行在mac上： 检查"),_("code",[v._v("navigator.userAgent")]),v._v(" 字符串中是否包含"),_("code",[v._v("macintosh")]),v._v(" 子串（如果同时包含"),_("code",[v._v("applewebkit")]),v._v("和"),_("code",[v._v("macintosh")]),v._v("子串，则说明是运行在mac OS上的"),_("code",[v._v("webkit")]),v._v("内核浏览器）")])]),v._v(" "),_("li",[_("p",[v._v("浏览器是是否运行在怪异模式下： 检查 "),_("code",[v._v("document.compatMode")]),v._v(" 属性，如果值为"),_("code",[v._v("BackCompat")]),v._v("则为怪异模式，如果值为"),_("code",[v._v("CSS1Compat")]),v._v(" ,则为标准模式。")])]),v._v(" "),_("li",[_("p",[_("code",[v._v("gecko")]),v._v(" 内核浏览器： "),_("code",[v._v("navigator.product")]),v._v(" 为"),_("code",[v._v("Gecko")]),v._v(" ，并且不是上面三种内核（opera/webkit/ie）")])])]),v._v(" "),_("p",[v._v("然后看下具体的版本检测原理：")]),v._v(" "),_("ul",[_("li",[_("p",[_("code",[v._v("IE")]),v._v(": 分三种情况")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("同时具有"),_("code",[v._v("msie")]),v._v("和"),_("code",[v._v("trident")]),v._v("标识，选取两个版本号中较大的一个")])]),v._v(" "),_("li",[_("p",[v._v("只包含"),_("code",[v._v("msie")]),v._v("标识的，直接采用该标识后面跟的版本号")])]),v._v(" "),_("li",[_("p",[v._v("只包含"),_("code",[v._v("trident")]),v._v("标识的，直接采用该标识后面跟的版本号")]),v._v(" "),_("p",[v._v("如果都没有，则版本号为 0；")])])])]),v._v(" "),_("li",[_("p",[_("code",[v._v("IE")]),v._v(" 的兼容模式判断")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("IE9兼容模式")]),v._v(" ： "),_("code",[v._v("document.documentMode")]),v._v(" 值为 9;")]),v._v(" "),_("li",[_("code",[v._v("IE11兼容模式")]),v._v(" ： "),_("code",[v._v("document.documentMode")]),v._v(" 值为 11;")]),v._v(" "),_("li",[_("code",[v._v("IE8兼容模式")]),v._v(" ： "),_("code",[v._v("document.documentMode")]),v._v(" 值为 8;")]),v._v(" "),_("li",[_("code",[v._v("IE7兼容模式")]),v._v(" ： "),_("code",[v._v("document.documentMode")]),v._v(" 值为 7， 或者 "),_("code",[v._v("document.documentMode")]),v._v("的值未定义，但版本号为7;")]),v._v(" "),_("li",[_("code",[v._v("IE6兼容模式")]),v._v(" ： 版本号小于 7 或者 浏览器处于怪异模式下")])])]),v._v(" "),_("li",[_("p",[_("code",[v._v("IE")]),v._v("其它版本：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("IE9")]),v._v("及以上 ： 版本号大于8")]),v._v(" "),_("li",[_("code",[v._v("IE9")]),v._v("以下： 版本号小于 9")]),v._v(" "),_("li",[_("code",[v._v("IE11")]),v._v("及以上： 版本号大于10")]),v._v(" "),_("li",[_("code",[v._v("IE11")]),v._v(" 以下： 版本号小于 11")])])]),v._v(" "),_("li",[_("p",[_("code",[v._v("Gecko")]),v._v(" 版本号判断（主要用于"),_("code",[v._v("firefox")]),v._v("浏览器）")]),v._v(" "),_("ul",[_("li",[v._v("匹配"),_("code",[v._v("navigator.userAgent")]),v._v("中 "),_("code",[v._v("rv:")]),v._v("后面的数字")]),v._v(" "),_("li",[v._v("使用"),_("code",[v._v(".")]),v._v("分割符分割匹配到的数字")]),v._v(" "),_("li",[v._v("第一位乘以10000，第二位乘以100，第三位乘以1，相加后就是最终的版本号，例如匹配的数字为1.9，则版本号为：10900")])])]),v._v(" "),_("li",[_("p",[_("code",[v._v("chrome")]),v._v(" 浏览器版本号：")]),v._v(" "),_("ul",[_("li",[v._v("检测当前浏览器是否为Chrome, 如果是，则返回Chrome的大版本号")]),v._v(" "),_("li",[v._v("检测是否为"),_("code",[v._v("Chrome")]),v._v(": 检查"),_("code",[v._v("navigator")]),v._v("中是否包含"),_("code",[v._v("chrome")]),v._v("标识")])])]),v._v(" "),_("li",[_("p",[_("code",[v._v("safari")]),v._v("浏览器版本的检测")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("navigator.userAgent")]),v._v(" 不包含"),_("code",[v._v("chrome")]),v._v("标识")]),v._v(" "),_("li",[_("code",[v._v("navigator.userAgent")]),v._v(" 包含 "),_("code",[v._v("safari标识")])]),v._v(" "),_("li",[v._v("正则匹配"),_("code",[v._v("safari")]),v._v("标识前后的数字就是版本号")])])]),v._v(" "),_("li",[_("p",[v._v("在以上两种浏览器的版本号匹配中，我们会看到程序中有以下代码：")]),v._v(" "),_("div",{staticClass:"language-javascript line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-javascript"}},[_("code",[_("span",{pre:!0,attrs:{class:"token operator"}},[v._v("+")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("(")]),v._v("RegExp"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("[")]),_("span",{pre:!0,attrs:{class:"token string"}},[v._v("'\\x241'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("]")]),v._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[v._v("||")]),v._v(" RegExp"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("[")]),_("span",{pre:!0,attrs:{class:"token string"}},[v._v("'\\x242'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("]")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(")")]),v._v("\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br")])]),_("p",[v._v("这实际上代表了正则表达式中匹配到的分组，"),_("code",[v._v("\\x241")]),v._v(" 代表"),_("code",[v._v("$1")]),v._v("， "),_("code",[v._v("\\x242")]),v._v(" 代表 "),_("code",[v._v("$2")]),v._v(".")])]),v._v(" "),_("li",[_("p",[_("code",[v._v("opera")]),v._v(" 浏览器版本号获取")]),v._v(" "),_("ul",[_("li",[v._v("直接使用 "),_("code",[v._v("window.opera.version()")]),v._v(" 方法获取")])])]),v._v(" "),_("li",[_("p",[v._v("最后，提供了一个属性来检测当前浏览器是否能与编辑器良好兼容：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("UE.browser.isCompatible")])])])])])])}),[],!1,null,null,null);e.default=a.exports}}]);