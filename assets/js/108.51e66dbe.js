(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{522:function(s,t,a){"use strict";a.r(t);var e=a(15),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vscode-wsl-docker-开发环境构建指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode-wsl-docker-开发环境构建指南"}},[s._v("#")]),s._v(" VsCode+WSL+Docker 开发环境构建指南")]),s._v(" "),a("h2",{attrs:{id:"why-为什么整这种活"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-为什么整这种活"}},[s._v("#")]),s._v(" Why——为什么整这种活")]),s._v(" "),a("p",[s._v("在实际开发中，我们遇到了以下类型的问题：")]),s._v(" "),a("h3",{attrs:{id:"_1-不同工程对nodejs版本要求不一样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-不同工程对nodejs版本要求不一样"}},[s._v("#")]),s._v(" 1. 不同工程对nodejs版本要求不一样")]),s._v(" "),a("p",[s._v("比如我们的工程A是基于"),a("code",[s._v("angularjs1.5")]),s._v("的，它要求"),a("code",[s._v("nodejs")]),s._v("版本为"),a("code",[s._v("11.0.0")]),s._v("， 而工程B是基于"),a("code",[s._v("vue+vite")]),s._v("的，"),a("code",[s._v("vite")]),s._v("要求"),a("code",[s._v("nodejs")]),s._v("版本需要大于"),a("code",[s._v("12.0.0")]),s._v("。")]),s._v(" "),a("p",[s._v("尽管有"),a("code",[s._v("nvm")]),s._v("来管理"),a("code",[s._v("nodejs")]),s._v("版本，但它仍旧存在以下问题：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("全局环境污染")]),s._v(" "),a("p",[s._v("比如"),a("code",[s._v("angularjs")]),s._v("工程是基于"),a("code",[s._v("gulp")]),s._v("的，所以需要全局安装"),a("code",[s._v("gulp")]),s._v("包，但是其他工程用不到，而"),a("code",[s._v("vue")]),s._v("工程则需要全局安装"),a("code",[s._v("vue-cli")]),s._v("，这样同一个"),a("code",[s._v("windows")]),s._v("环境下，安装了太多全局包，如果以后又有别的项目工程需要其他的全局包，那我们都得安装在同一个环境下，万一有两个工程所依赖的全局包相同但版本不同，就会造成全局环境的污染")])]),s._v(" "),a("li",[a("p",[s._v("切换"),a("code",[s._v("node")]),s._v("版本后全局包需要重新安装")]),s._v(" "),a("p",[s._v("切换本地"),a("code",[s._v("node")]),s._v("版本后，在之前"),a("code",[s._v("node")]),s._v("版本下安装的全局包都无法使用，需要重新安装，比如我们常用的"),a("code",[s._v("cnpm")]),s._v("、"),a("code",[s._v("nrm")]),s._v("等等。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("nvm")]),s._v("本身的安装也存在一些坑。")]),s._v(" "),a("p",[s._v("之前好几位同事安装"),a("code",[s._v("nvm")]),s._v("都因为环境和版本的问题多多少少踩了一些坑，费时费力，不太安逸。")])])]),s._v(" "),a("h3",{attrs:{id:"_2-某些npm包需要linux编译环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-某些npm包需要linux编译环境"}},[s._v("#")]),s._v(" 2. 某些npm包需要linux编译环境")]),s._v(" "),a("p",[s._v("典型地，如"),a("code",[s._v("node-sass")]),s._v("这个包，比如当我们想将它从"),a("code",[s._v("4.4.1")]),s._v("版本升级到"),a("code",[s._v("6.0.1")]),s._v("版本时，我们会敲下以下命令:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" node-sass@6.0.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("然后，噩梦就来临了，由于"),a("code",[s._v("node-sass")]),s._v("采用的是二进制文件分发，所以需要本地具有可以编译它的环境，比如"),a("code",[s._v("python")]),s._v("，"),a("code",[s._v("gyp")]),s._v("等等，但是一般来说，我们的"),a("code",[s._v("Windows")]),s._v("上并没有这些环境，所以就会报一堆错，而"),a("code",[s._v("Windows")]),s._v("如果想要安装这种环境，又需要安装一些很冷门还很难装的软件与库，搞得及其烦人。")]),s._v(" "),a("h3",{attrs:{id:"_3-需要适应未来devops转型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-需要适应未来devops转型"}},[s._v("#")]),s._v(" 3. 需要适应未来DevOps转型")]),s._v(" "),a("p",[s._v("现在很多大厂已经转型"),a("code",[s._v("DevOps")]),s._v("了，云计算和容器化是一种大趋势，随着业务量与项目数量的增长，开发和运维都面临着向DevOps的转型，所以提前进行容器化开发，可以为未来"),a("code",[s._v("容器化开发——容器化部署")]),s._v("模式铺平道路。")]),s._v(" "),a("h2",{attrs:{id:"what-方案简述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#what-方案简述"}},[s._v("#")]),s._v(" What——方案简述")]),s._v(" "),a("p",[s._v("我们采用"),a("code",[s._v("Vscode + Docker + WSL")]),s._v("来解决上述问题。")]),s._v(" "),a("h3",{attrs:{id:"vscode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode"}},[s._v("#")]),s._v(" VsCode")]),s._v(" "),a("p",[s._v("不必多介绍，一款流行的编辑器，在本方案中，它只需要安装两个插件即可：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Remote-Containers")]),s._v("：用于连接远程容器")]),s._v(" "),a("li",[a("code",[s._v("Remote-WSL")]),s._v("： 用于连接本地的WSL")])]),s._v(" "),a("h3",{attrs:{id:"wsl-windows-subsystem-linux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wsl-windows-subsystem-linux"}},[s._v("#")]),s._v(" WSL（windows subsystem linux）")]),s._v(" "),a("p",[s._v("Windows系统下的Linux子系统，它在这里主要起的作用是用来提供一个linux环境，一是提供给docker作为运行环境，二是用来解决上述某些npm包需要linux编译环境的问题。")]),s._v(" "),a("p",[s._v("想更深入地了解WSL？ "),a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/about",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击这里"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("p",[s._v("一款容器应用，它可以提供比虚拟机更加快捷和对硬件资源消耗更少的虚拟化方案，为我们的提供一个虚拟的服务器和开发环境。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-containers",target:"_blank",rel:"noopener noreferrer"}},[s._v("WSL上的Docker远程容器入门"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"how-如何搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-如何搭建"}},[s._v("#")]),s._v(" How——如何搭建")]),s._v(" "),a("h3",{attrs:{id:"_1-安装配置wsl-2-0版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装配置wsl-2-0版本"}},[s._v("#")]),s._v(" 1. 安装配置WSL 2.0版本")]),s._v(" "),a("p",[s._v("最新的Windws10默认都是直接支持WSL2的，我们只需要在windows应用商店搜索"),a("code",[s._v("linux")]),s._v("，就能看到支持的"),a("code",[s._v("Linux")]),s._v("子系统列表，选择其中一个安装就可以了。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090920251.png",alt:"image-20211009092023034"}})]),s._v(" "),a("p",[s._v("当然，推荐的话，还是"),a("code",[s._v("ubuntu")]),s._v("比较流行，遇到问题也比较容易搜索到相关解决方案。")]),s._v(" "),a("p",[s._v("为了更好地操作，推荐在应用商店中搜索"),a("code",[s._v("windows terminal")]),s._v("安装。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090922910.png",alt:"image-20211009092216803"}})]),s._v(" "),a("p",[s._v("另外，由于WSL是基于Hype-V技术的，需要Windows开启相关功能，并且保证BIOS中的虚拟化选项开启，由于不同电脑BIOS的设置方式不同，请自行在网络上搜索相关设置方法。")]),s._v(" "),a("p",[s._v("如何判断电脑是否开启了虚拟化呢？ 打开任务管理器，切换到【性能】一栏，可以看到【CPU】下面的信息中标识了是否开启了虚拟化：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090924656.png",alt:"image-20211009092430535"}})]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/install",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方WSL安装教程"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows/wsl/setup/environment",target:"_blank",rel:"noopener noreferrer"}},[s._v("WSL开发环境设置"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("安装后，我们需要对默认WSL发新版和发行版的版本进行配置")]),s._v(" "),a("p",[s._v("在windows搜索框里输入 windows terminal，打开它")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121845212.png",alt:"image-20211012184537098"}})]),s._v(" "),a("p",[s._v("输入以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" wsl -l --verbose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("会列出本机现在安装的所有WSL发行版以及它的版本")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("  NAME                   STATE           VERSION\n* Ubuntu                 Running         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  docker-desktop-data    Running         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  docker-desktop         Running         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("系统默认的那个发行版前会有一个"),a("code",[s._v("*")]),s._v("号，也就是，当你在"),a("code",[s._v("windows Terminal")]),s._v("中直接输入"),a("code",[s._v("wsl")]),s._v("时，打开的那个发行版：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("PS C:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("trs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" wsl\nroot@DESKTOP-RG3539D:/mnt/c/Users/trs"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("如果你发现你刚刚安装的"),a("code",[s._v("Ubuntu")]),s._v("不是默认的发行版，使用以下命令将它设置为默认发行版：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" wsl --set-default ubuntu\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果你发现你的"),a("code",[s._v("Ubuntu")]),s._v("的版本不是"),a("code",[s._v("2")]),s._v(",使用以下命令转换其版本：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" wsl --set-version ubuntu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-安装配置docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装配置docker"}},[s._v("#")]),s._v(" 2. 安装配置Docker")]),s._v(" "),a("p",[s._v("Windows需要去官网下载Docker desktop最新版本，下载安装文件后直接安装即可。")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/desktop/windows/wsl/",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击这里下载"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090927230.png",alt:"image-20211009092713131"}})]),s._v(" "),a("p",[s._v("安装好之后，我们要进行以下配置，运行"),a("code",[s._v("docker-desktop")]),s._v("程序")]),s._v(" "),a("p",[s._v("保证以下选项为勾选状态：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121853544.png",alt:"image-20211012185324443"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121854848.png",alt:"image-20211012185406762"}})]),s._v(" "),a("p",[s._v("修改一下"),a("code",[s._v("docker")]),s._v("镜像源和配置：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121856738.png",alt:"image-20211012185645645"}})]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://hub-mirror.c.163.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.mirrors.ustc.edu.cn"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"insecure-registries"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"debug"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"experimental"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"features"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"buildkit"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"builder"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"gc"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"enabled"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"defaultKeepStorage"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"20GB"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h3",{attrs:{id:"_3-安装配置vscode相关插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装配置vscode相关插件"}},[s._v("#")]),s._v(" 3. 安装配置VsCode相关插件")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090928351.png",alt:"image-20211009092815254"}})]),s._v(" "),a("h3",{attrs:{id:"_4-在wsl容器中开发调试应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-在wsl容器中开发调试应用"}},[s._v("#")]),s._v(" 4. 在WSL容器中开发调试应用")]),s._v(" "),a("h5",{attrs:{id:"自动创建容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动创建容器"}},[s._v("#")]),s._v(" 自动创建容器")]),s._v(" "),a("p",[s._v("插件安装成功后，在"),a("code",[s._v("VsCode")]),s._v("中打开工程目录，会看到左下角有两个相对的箭头的标识，点击它，就会弹出命令选项，让我们选择在哪里打开：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090930143.png",alt:"image-20211009093045937"}})]),s._v(" "),a("p",[s._v("在确保"),a("code",[s._v("docker desktop")]),s._v(" 正常运行的前提下，我们可以选择在"),a("code",[s._v("WSL")]),s._v("中开发目录，也可以选择在容器内打开当前工程目录，这里我们选择在容器内打开。它会让我们选择要打开的目录，默认为当前目录：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090938031.png",alt:"image-20211009093849854"}})]),s._v(" "),a("p",[s._v("我们直接点击【Open】，它会让我们选择当前工程的环境类型：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110090940780.png",alt:"image-20211009094008663"}})]),s._v(" "),a("p",[s._v("这里是前端项目，我们直接选择【Nodejs】，然后它会让我们选择当前工程所使用的"),a("code",[s._v("nodejs")]),s._v("版本，选择相应的版本，就可以了，容器会自动下载相关的"),a("code",[s._v("nodejs")]),s._v("环境。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110091001533.png",alt:"image-20211009100141449"}})]),s._v(" "),a("p",[a("code",[s._v("VsCode")]),s._v("在配置好相关环境后，会在当前目录下生成一个一个名为"),a("code",[s._v(".devcontainer")]),s._v("的文件夹，里面存放着容器的环境配置，有了这个配置，下次再在容器中打开工程目录时，就不会再让我们选择工程环境类型了。")]),s._v(" "),a("p",[s._v("当然，为了不污染项目文件，可以把这个目录加入到"),a("code",[s._v(".gitignore")]),s._v("文件中。")]),s._v(" "),a("p",[s._v("之后，我们就可以像在本地开发一样，在容器内进行开发了。")]),s._v(" "),a("h5",{attrs:{id:"手动创建容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动创建容器"}},[s._v("#")]),s._v(" 手动创建容器")]),s._v(" "),a("p",[s._v("我们发现，在选择"),a("code",[s._v("NodeJS")]),s._v("版本那一步，只有少数几个版本，比如我们需要"),a("code",[s._v("10.17.0")]),s._v("的话，这里就没有，怎么办呢，我们有另一种方式。")]),s._v(" "),a("p",[s._v("在工程根目录下新建"),a("code",[s._v("Dockerfile")]),s._v("文件，")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node:10.17.0 # 这里写上需要的nodejs版本")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /usr/src/app")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" package*.json ./")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm install")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8090 # 这里是应用在开发时默认运行的端口")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" [ "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"serve"')]),s._v("]  # 拆解的开发命令 npm run serve")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("然后新建docker忽略文件"),a("code",[s._v(".dockerignore")]),s._v(" :")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[s._v("node_modules\nnpm-debug.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("新建后，点击左下角远程容器按钮，选择【在WSL中打开】：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121904365.png",alt:"image-20211012190451098"}})]),s._v(" "),a("p",[s._v("选择当前目录打开：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121905722.png",alt:"image-20211012190546522"}})]),s._v(" "),a("p",[s._v("在VS code 终端中，可以看到现在终端是在WSL中，运行以下命令:,(可以把"),a("code",[s._v("hjb/netresource")]),s._v("替换成你自己想要的任何可以描述该容器的名字)")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("root@DESKTOP-RG3539D:/mnt/d/project/tianmuyun/netresource"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build . -t hjb/netresource")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面的命令会构建一个新的镜像，镜像中包含所需要的node版本环境和你的工程代码。")]),s._v(" "),a("p",[s._v("接下来运行：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("root@DESKTOP-RG3539D:/mnt/d/project/tianmuyun/netresource"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -p 8090:8090 -d hjb/netresource")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("上面的命令会使用你刚刚构建的镜像实例化一个容器，并且会自动运行你在"),a("code",[s._v("Dockerfile")]),s._v("最后所设置的命令（这里是"),a("code",[s._v("npm run serve")]),s._v("），并且将容器内应用的运行端口"),a("code",[s._v("8090")]),s._v("映射到了本机的"),a("code",[s._v("8090")]),s._v("端口")]),s._v(" "),a("p",[s._v("然后可以通过下面命令看看运行的容器：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS                                       NAMES\n2e569ac583be   hjb/netresource   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-entrypoint.s…"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" seconds ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" seconds   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8090-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),s._v("/tcp, :::8090-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),s._v("/tcp   inspiring_khorana\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这里我们可以拿到输出的容器ID，用这个ID来查看docker内的运行日志：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logs 2e569ac583be")]),s._v("\n\n net-resource@0.1.0 build /usr/src/app\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" vue-cli-service build\n\n\n-  Building "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" production"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nBrowserslist: caniuse-lite is outdated. Please run:\nnpx browserslist@latest --update-db\nBrowserslist: caniuse-lite is outdated. Please run:\nnpx browserslist@latest --update-db\nBrowserslist: caniuse-lite is outdated. Please run:\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("当然，我们也可以在windows的docker-desktop里看到刚刚实例化运行起来的容器运行日志：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110121915835.png",alt:"image-20211012191534715"}})]),s._v(" "),a("p",[s._v("从日志看到应用成功运行起来后，就可以在本地访问"),a("code",[s._v("8090")]),s._v("端口来浏览应用了。")]),s._v(" "),a("p",[s._v("当然，此时，我们修改工作区的内容，容器内的应用并不会刷新，因为现在容器内打开的是我们复制到容器中"),a("code",[s._v("usr/src/app")]),s._v("里的代码，而不是我们工作区的代码。要想像在windows下一样调试，可以进行以下操作：")]),s._v(" "),a("p",[s._v("点击远程容器图标：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130942111.png",alt:"image-20211013094238016"}})]),s._v(" "),a("p",[s._v("选择关闭远程连接")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130943461.png",alt:"image-20211013094318379"}})]),s._v(" "),a("p",[s._v("然后重新点击本地的远程容器图标：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130943915.png",alt:"image-20211013094356859"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130944393.png",alt:"image-20211013094421304"}})]),s._v(" "),a("p",[s._v("选择进入一个运行中的容器，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130945673.png",alt:"image-20211013094503611"}})]),s._v(" "),a("p",[s._v("选择我们之前运行起来的容器，此时VSCODE会打开一个新的远程窗口")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130949042.png",alt:"image-20211013094905936"}})]),s._v(" "),a("p",[s._v("我们在新窗口的工作区目录区域右键，选择添加文件夹到工作区，然后在弹出的框里输入我们在"),a("code",[s._v("DockerFile")]),s._v("里设置的"),a("code",[s._v("WORKDIR")]),s._v("路径，选择并确定")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130950150.png",alt:"image-20211013095007073"}})]),s._v(" "),a("p",[s._v("然后工作区目录中就有我们在容器内运行的工程文件了。")]),s._v(" "),a("p",[s._v("接下来就可以像在平时"),a("code",[s._v("windows")]),s._v("下一样修改和调试代码了，如果想进行git操作，在VSCODE中打开终端像平时操作一样就可以了。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/hjb2722404/tuchuang/raw/master/img/202110130953170.png",alt:"image-20211013095314887"}})]),s._v(" "),a("h3",{attrs:{id:"_5-其它注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-其它注意事项"}},[s._v("#")]),s._v(" 5. 其它注意事项")]),s._v(" "),a("ul",[a("li",[s._v("由于该容器与本机的"),a("code",[s._v("Git")]),s._v("共享凭证信息，所以即使在容器内，也可以进行与远程"),a("code",[s._v("Git")]),s._v("仓库的交互操作。")]),s._v(" "),a("li",[s._v("尽管我们是在容器内打开的目录，但只是把本地目录挂载到了容器内，所以容器内对工程文件所做的修改，就是对本地目录内工程文件的修改。")]),s._v(" "),a("li",[s._v("有一个例外，就是我们在容器内运行"),a("code",[s._v("npm install")]),s._v("安装的包，再切换回本地工程，是无法使用的，需要重新在本地跑"),a("code",[s._v("npm install")]),s._v("才行。")])])])}),[],!1,null,null,null);t.default=n.exports}}]);